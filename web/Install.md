# Dependencies

* ~~librabbitmq-dev~~
* redis-server

# Installing

1. Clone this repo.
2. Install all dependencies with `pip install -r requirements.txt`.
  * You may need to install the appropriate DB driver as well.
3. Install NLTK data with `python -m nltk.downloader punkt`.
4. Create directory named `local` in the root folder of the project.
5. Set the active Django settings module (e.g. with `export DJANGO_SETTINGS_MODULE=settings.dev`).
6. Create DB with `python manage.py migrate`.
  * You may need to start the relevant DB backend first.
  * Currently, migrations are a little finicky to use, so it is possible that you might need to delete and remake them with `python manage.py makemigrations`.

# Running
You may need to start the Redis server beforehand, and edit the Django settings module to reflect the correct IP/port.
## Web server
Run the web server with `python manage.py runserver`.
## Worker process
Start the celery worker with `celery worker -A revup.common -l DEBUG`.
If running the core gen, his command should be run in an Python environment with revup/core installed.

# Environment variables
* `BASE_DIR`: Base directory to put all files generated by normal running (e.g. logs, uploads, SQLite DB)
  * Defaults to `<project-root>/local*
* `REVUP_GEN`: Type of generator to use.
  * Values:
    * `core`: Use `revup.core` neural models to generate questions.
    * `fake`: Mock generator that returns random bits of Lorem Ipsum as answers.
  * Defaults to `fake`.
* `REVUP_MODELS`: When using the `core` generator, path of the directory containg all model files used by `revup.core`.
  * Defaults to `BASE_DIR/models`.
* `REVUP_FAKE_GEN_DELAY`: When using the `fake` generator, provides a integer delay in seconds between the processing of each question.
  * Defaults to `0`.
* `REVUP_FAKE_GEN_ERROR_PROB_RANGE`: When using the fake generator, each sentence has a `1/REVUP_FAKE_GEN_ERROR_PROB_RANGE` chance that the generator returns failure. Takes integer only.
 * Defaults to `0`.
